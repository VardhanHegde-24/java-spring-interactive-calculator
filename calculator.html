<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Spring Boot Calculator</title>
    <style>
        /* Root variables for light mode */
        :root {
            --bg-color: #f0f4f8;
            --card-bg: #ffffff;
            --text-color: #333333;
            --text-color-secondary: #555555;
            --input-bg: #ffffff;
            --input-border: #ccc;
            --input-focus-border: #0078d7;
            --button-bg: #0078d7;
            --button-hover-bg: #005ea3;
            --result-color: #0078d7;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        /* Dark mode overrides */
        body.dark-mode {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --text-color-secondary: #bbbbbb;
            --input-bg: #2a2a2a;
            --input-border: #444;
            --input-focus-border: #3399ff;
            --button-bg: #3399ff;
            --button-hover-bg: #2277dd;
            --result-color: #66b3ff;
            --shadow-color: rgba(0, 0, 0, 0.7);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-color);
            padding: 40px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            transition: background 0.3s ease, color 0.3s ease;
            color: var(--text-color);
        }

        .calculator {
            background: var(--card-bg);
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 10px 25px var(--shadow-color);
            width: 320px;
            position: relative;
            transition: background 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
        }

        h2 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--text-color);
        }

        label {
            display: block;
            margin-bottom: 15px;
            font-weight: 600;
            color: var(--text-color-secondary);
        }

        input[type="number"], select {
            width: 100%;
            padding: 10px 12px;
            font-size: 16px;
            border: 1.8px solid var(--input-border);
            border-radius: 6px;
            background: var(--input-bg);
            color: var(--text-color);
            transition: border-color 0.3s ease, background 0.3s ease, color 0.3s ease;
            box-sizing: border-box;
        }

        input[type="number"]::placeholder {
            color: var(--text-color-secondary);
        }

        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: var(--input-focus-border);
            box-shadow: 0 0 5px var(--input-focus-border);
        }

        button {
            width: 100%;
            background: var(--button-bg);
            color: white;
            border: none;
            padding: 12px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s ease;
        }

        button:hover {
            background: var(--button-hover-bg);
        }

        h3 {
            text-align: center;
            margin-top: 30px;
            font-weight: 700;
            font-size: 22px;
            color: var(--text-color);
        }

        #result {
            color: var(--result-color);
        }

        .hidden {
            display: none;
        }

        /* Dark mode toggle container */
        .dark-mode-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            align-items: center;
            user-select: none;
            font-size: 14px;
            color: var(--text-color-secondary);
        }

        /* The switch - the box around the slider */
        .switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 26px;
            margin-left: 8px;
        }

        /* Hide default HTML checkbox */
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* The slider */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc;
            border-radius: 26px;
            transition: 0.4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            border-radius: 50%;
            transition: 0.4s;
        }

        input:checked + .slider {
            background-color: var(--button-bg);
        }

        input:checked + .slider:before {
            transform: translateX(22px);
        }
    </style>
</head>
<body>
<div class="calculator">
    <div class="dark-mode-toggle" title="Toggle Dark Mode">
        Dark Mode
        <label class="switch">
            <input type="checkbox" id="darkModeToggle" />
            <span class="slider"></span>
        </label>
    </div>
    <h2>Interactive Calculator</h2>
    <label for="num1">First Number:
        <input type="number" id="num1" placeholder="Enter first number" />
    </label>
    <label for="num2" id="num2-label">Second Number:
        <input type="number" id="num2" placeholder="Enter second number" />
    </label>
    <label for="operation">Operation:
        <select id="operation">
            <option value="add">Add (+)</option>
            <option value="subtract">Subtract (-)</option>
            <option value="multiply">Multiply (*)</option>
            <option value="divide">Divide (/)</option>
            <option value="mod">Mod (%)</option>
            <option value="factorial">Factorial (!)</option>
        </select>
    </label>
    <button onclick="performCalculation()">Calculate</button>
    <h3>Result: <span id="result"></span></h3>
</div>

<script>
    const operationSelect = document.getElementById('operation');
    const num2Label = document.getElementById('num2-label');
    const num2Input = document.getElementById('num2');
    const darkModeToggle = document.getElementById('darkModeToggle');

    function toggleNum2Visibility() {
        if (operationSelect.value === 'factorial') {
            num2Label.classList.add('hidden');
            num2Input.value = '';
        } else {
            num2Label.classList.remove('hidden');
        }
    }

    operationSelect.addEventListener('change', toggleNum2Visibility);

    function performCalculation() {
        const a = document.getElementById("num1").value;
        const b = document.getElementById("num2").value;
        const operation = operationSelect.value;

        if (!a) {
            alert('Please enter the first number.');
            return;
        }

        if (operation !== 'factorial' && !b) {
            alert('Please enter the second number.');
            return;
        }

        let url = `/api/calculator/calculate?operation=${operation}&a=${a}`;
        if (operation !== "factorial") {
            url += `&b=${b}`;
        }

        fetch(url)
            .then(res => {
                if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                return res.text();
            })
            .then(data => {
                document.getElementById("result").textContent = data;
            })
            .catch(err => {
                document.getElementById("result").textContent = "Error: " + err;
            });
    }

    // Dark mode toggle handler
    darkModeToggle.addEventListener('change', () => {
        document.body.classList.toggle('dark-mode', darkModeToggle.checked);
    });

    // Initialize on page load
    toggleNum2Visibility();
</script>
</body>
</html>
